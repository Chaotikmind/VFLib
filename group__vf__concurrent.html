<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>VFLib: vf_concurrent</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">VFLib
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">vf_concurrent</div>  </div>
</div><!--header-->
<div class="contents">

<p>Classes for building a concurrent system.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:vf__concurrent_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vf__concurrent_8cpp.html">vf_concurrent.cpp</a></td></tr>
<tr class="memdesc:vf__concurrent_8cpp"><td class="mdescLeft">&#160;</td><td class="mdescRight"><p>Add this to get the <a class="el" href="group__vf__concurrent.html">vf_concurrent</a> module. </p>
<br/></td></tr>
<tr class="memitem:vf__concurrent_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vf__concurrent_8h.html">vf_concurrent.h</a></td></tr>
<tr class="memdesc:vf__concurrent_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight"><p>Include this to get the <a class="el" href="group__vf__concurrent.html">vf_concurrent</a> module. </p>
<br/></td></tr>
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_call_queue.html">CallQueue</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A FIFO for calling functors asynchronously.  <a href="class_call_queue.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_concurrent_object.html">ConcurrentObject</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A reference counted object, deleted on a separate thread.  <a href="class_concurrent_object.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_concurrent_state.html">ConcurrentState&lt; Object &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structured access to a shared state.  <a href="class_concurrent_state.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_global_thread_group.html">GlobalThreadGroup</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <a class="el" href="class_thread_group.html" title="A group of threads for parallelizing tasks.">ThreadGroup</a> singleton.  <a href="class_global_thread_group.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gui_call_queue.html">GuiCallQueue</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <a class="el" href="class_call_queue.html" title="A FIFO for calling functors asynchronously.">CallQueue</a> handled by the Juce message thread (gui).  <a href="class_gui_call_queue.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_manual_call_queue.html">ManualCallQueue</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <a class="el" href="class_call_queue.html" title="A FIFO for calling functors asynchronously.">CallQueue</a> that requires periodic manual synchronization.  <a href="class_manual_call_queue.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_message_thread.html">MessageThread</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <a class="el" href="class_gui_call_queue.html" title="A CallQueue handled by the Juce message thread (gui).">GuiCallQueue</a> singleton for the message thread.  <a href="class_message_thread.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_parallel_for.html">ParallelFor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parallel for loop.  <a href="class_parallel_for.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_generic_scoped_read_lock.html">GenericScopedReadLock&lt; LockType &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scoped read lock for <a class="el" href="class_read_write_mutex.html" title="Multiple consumer, single producer (MCSP) synchronization primitive.">ReadWriteMutex</a>.  <a href="struct_generic_scoped_read_lock.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_generic_scoped_write_lock.html">GenericScopedWriteLock&lt; LockType &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scoped write lock for <a class="el" href="class_read_write_mutex.html" title="Multiple consumer, single producer (MCSP) synchronization primitive.">ReadWriteMutex</a>.  <a href="struct_generic_scoped_write_lock.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thread_group.html">ThreadGroup</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A group of threads for parallelizing tasks.  <a href="class_thread_group.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_thread_with_call_queue.html">ThreadWithCallQueue</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An <a class="el" href="class_interruptible_thread.html" title="A thread with soft interruption support.">InterruptibleThread</a> with a <a class="el" href="class_call_queue.html" title="A FIFO for calling functors asynchronously.">CallQueue</a>.  <a href="class_thread_with_call_queue.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_listeners.html">Listeners&lt; ListenerClass &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A group of concurrent <a class="el" href="class_listeners.html" title="A group of concurrent Listeners.">Listeners</a>.  <a href="class_listeners.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_read_write_mutex.html">ReadWriteMutex</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiple consumer, single producer (MCSP) synchronization primitive.  <a href="class_read_write_mutex.html#details">More...</a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>This module offers a specially crafted set of classes that work together to solve a fundamental problem encountered when designing any concurrent system: synchronization and sharing of state information between multiple threads of execution. Desiging and maintaining these systems is difficult:</p>
<dl class="section user"><dt>The Trouble with Locks</b></dt><dd><em>Unfortunately, today's reality is that only thoughtful experts can write explicitly concurrent programs that are correct and efficient. This is because today's programming models for concurrency are subtle, intricate, and fraught with pitfalls that easily (and frequently) result in unforeseen races (i.e., program corruption) deadlocks (i.e., program lockup) and performance cliffs (e.g., priority inversion, convoying, and sometimes complete loss of parallelism and/or even worse performance than a single-threaded program). And even when a correct and efficient concurrent program is written, it takes great care to maintain - it's usually brittle and difficult to maintain correctly because current programming models set a very high bar of expertise required to reason reliably about the operation of concurrent programs, so that apparently innocuous changes to a working concurrent program can (and commonly do, in practice) render it entirely or intermittently nonworking in unintended and unexpected ways. Because getting it right and keeping it right is so difficult, at many major software companies there is a veritable priesthood of gurus who write and maintain the core concurrent code. </em> <br/>
 - <a href="http://drdobbs.com/cpp/184401930" title="The Trouble with Locks">Herb Sutter</a></dd></dl>
<p>We offer an alternative approach to traditional synchronization methods, with these features:</p>
<ul>
<li>Fast paths are lock free.</li>
</ul>
<ul>
<li>Deadlocks are avoided.</li>
</ul>
<ul>
<li>Object histories are <a href="http://en.wikipedia.org/wiki/Linearizability" title="Linearizability">linearizable</a>.</li>
</ul>
<ul>
<li>Invocations and responses run in bounded time.</li>
</ul>
<p>The resulting concurrent system is simpler to design and analyze, higher in theoretical performance, and easier to maintain over the traditional approach.</p>
<h2>Traditional Approach</h2>
<p>The traditional approach uses a <a href="http://en.wikipedia.org/wiki/Critical_section" title="Critical section">critical section</a> (implemented by the JUCE object of the same name, <a class="elRef" doxygen="juce.tag:http://www.rawmaterialsoftware.com/juce/api//" href="http://www.rawmaterialsoftware.com/juce/api/classCriticalSection.html">CriticalSection</a>) to protect a shared state and enforce mutual exclusion of access. We will consider a simplified example of a shared state consisting of the playback speed, owned by the AudioDeviceIOCallback, and the user interface logic owned by the message thread. In our example, the user interface queries the audio thread to get the initial playback speed, and changes the shared state in response to user interface actions:</p>
<div class="fragment"><pre class="fragment">  <span class="keyword">class </span>AudioThread : <span class="keyword">public</span> AudioDeviceIOCallback
  {
  <span class="keyword">public</span>:
    <span class="comment">// This lock protects our shared state</span>
    <a class="codeRef" doxygen="juce.tag:http://www.rawmaterialsoftware.com/juce/api//" href="http://www.rawmaterialsoftware.com/juce/api/classCriticalSection.html">CriticalSection</a>&amp; getCriticalSection ();

    <span class="keywordtype">void</span> setPlaybackSpeed ()
    <a class="codeRef" doxygen="juce.tag:http://www.rawmaterialsoftware.com/juce/api//" href="http://www.rawmaterialsoftware.com/juce/api/classResamplingAudioSource.html">ResamplingAudioSource</a>&amp; getResampler ();

    <span class="comment">//...</span>
    
    <span class="keywordtype">void</span> audioDeviceIOCallback (...)
    {
      <span class="comment">// Take the lock to access the shared state</span>
      {
        <a class="codeRef" doxygen="juce.tag:http://www.rawmaterialsoftware.com/juce/api//" href="http://www.rawmaterialsoftware.com/juce/api/classGenericScopedLock.html">CriticalSection::ScopedLockType</a> lock (getCriticalSection ());
      }
    }
  };

  AudioThread audioThread;

  <span class="keyword">class </span>Gui
  {
  <span class="keyword">public</span>:
    <span class="comment">// Called when the user changes the resampling ratio</span>
    <span class="keywordtype">void</span> userChangedResamplingRatio (<span class="keywordtype">double</span> newRatio)
    {
      
    }
  };
</pre></div><h2>Deadlock</h2>
<p>Calling into unknown code can cause deadlock. </p>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue May 1 2012 18:56:27 for VFLib by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
